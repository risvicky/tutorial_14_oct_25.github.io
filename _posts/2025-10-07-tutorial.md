---
title: "Solvation of Carbon Dioxide in Water"
date: 2025-10-07
author: "Risnita Vicky Listyarini"
---

The objective of this tutorial is to perform molecular dynamics simulation using open-source software GROMACS to study the solvation of carbon dioxide (CO<sub>2</sub>) in water.

To give a brief background, CO<sub>2</sub> is one of the most abundant greenhouse gases in the atmosphere next to CH<sub>4</sub>.
Its increasing concentration is a major contributor to global warming. CO<sub>2</sub> capture and subseqeuent storage (CCS) is a promising technology to mitigate CO<sub>2</sub> emissions. CO<sub>2</sub> can be captures via absorption in materials and converted to other substrates e.g. methane, methanol and formic acid. Therefore, understanding CO<sub>2</sub> behaviour in aqueous environments provide insights into its solubility, diffusion, and catalytic processes considering an explicit description of the surrounding solvent.[2,3]

The tutorial will guide you through the steps of setting up the simulation, adding species to the system and solvating it with water.
It will also introduce key points in MD simulation e.g. energy minimisation,thermostating, and both *NVT* and *NPT* equilibration steps.

## Molecular Dynamics Simulation Steps
The following steps will be covered in this tutorial:
1. **Preparation of the System**: Setting up the initial configuration of CO<sub>2</sub> in a water box.
2. **Setting Up the Simulation Parameters**: Defining the force field and simulation parameters.
3. **Energy Minimization**: Performing energy minimisation to relax the system.
4. **Equilibration**: Running equilibration steps under *NVT* and *NPT* ensembles.
5. **Production Run**: Conducting the main simulation to collect data for analysis.
6. **Analysis**: Analysing the results to understand the solvation of CO<sub>2</sub> in water.

## Setting Up GROMACS environment
Make sure you can run GROMACS commands in your terminal. Load GROMACS by typing the following command in your terminal:
   ```bash
   module load gromacs/intel-2022.2/2022.1-single
    gmx --version
    gmx
   ```
   If this result appears,
   ```bash
    gmx
    -bash: gmx: command not found
   ```
   depending to the access node that your account has, for teaching node
   ```bash
    source /usr/local/gromacs/bin/GMXRC
    gmx
   ```
   To get more information about GROMACS installation and user guide, please visit [GROMACS website](https://manual.gromacs.org/current/install-guide/index.html).[1]

### Setting Up Molecular Visualisation Software
To visualise the molecular structure and simulation results, we can use program like Visual Molecular Dynamics (VMD) or PyMol.
We will use VMD program. [VMD](https://en.wikipedia.org/wiki/Visual_Molecular_Dynamics) is available to non-commercial users under a distribution-specific license which permits both use of the program and modification of its source code, at no charge. You just have to register your email to download the program.

To load the module,
   ```bash
    module load vmd/1.9.4
    vmd
   ```
If you are using ThinLinc, you need to do,
   ```bash
    module load vmd/1.9.4
    vglrun vmd
   ```

## Preparation of the System
Let us create a new directory for MD simulation files.
   ```bash
   mkdir co2_solvation
   cd co2_solvation
   ```
We will make an empty box by creating an empty file called `empty.gro`.
   ```bash
   touch empty.gro
   nedit empty.gro
   ```
`touch` command is used to create a new empty file, while `nedit` command opens a text editor with a standard GUI (graphical user interface) in Linux.
You can also open and edit the file using your favourite text editor in Linux.

Then, we will create a box with a size of 20 nm x 20 nm x 20 nm by copying and pasting the following lines into `empty.gro`.
   ```
    Cubic box
    0
    20.00000   20.00000   20.00000
   ```
The first line, `Cubic box`, is a comment line; the second line, `0`, indicates that there are no atoms in the box; and the third line specifies the dimensions of the box in nanometers, 10 nm in each direction (x, y, z). This ***.gro*** is written in [Gromos87](https://manual.gromacs.org/archive/5.0.4/online/gro.html) format. 

Next, we will add CO<sub>2</sub> molecules to the box. Within the same folder as `empty.gro`, make a new file called `co2.gro` and copy the following lines into it.
   ```
CO2 molecule
3
    1       CO2       C1       1   0.000   0.000   0.000
    1       CO2       O1       2   0.000   0.000  -0.121
    1       CO2       O2       3   0.000   0.000   0.121
1.00000   1.00000   1.00000
   ```
It contains 3 atoms named `C1`, `O1`, and `O2`, all grouped under the residue name `CO2`. 

Using the `gmx insert-molecules` command to add 10 CO<sub>2</sub> molecules to the empty box, type the following command in your terminal:

   ```bash
   gmx insert-molecules -ci co2.gro -f empty.gro -o conf.gro -nmol 10 -radius 0.5
   ```
The `insert-molecule` command inserts molecules into a simulation box. The `-ci` flag specifies the input file containing the molecule to be inserted, which is `co2.gro` in this case. The `-f` flag indicates the input file for the box, which is `empty.gro`. The `-o` flag specifies the output file name, which will be `conf.gro`, containing the new configuration with the inserted molecules. The `-nmol` flag indicates the number of molecules to insert (10 CO<sub>2</sub> molecules). The `-radius` flag sets the minimum distance between inserted molecules to avoid overlaps (set to 0.5 nm) 


## üß© Exercise

Use the `editconf` command to generate a cubic simulation box for our system.  
The molecule should be centred in the box, with a separation of **1 nm**.

<div class="exercise-box">
  <div class="exercise-header">Exercise</div>
  <p>
    Use the <code>editconf</code> command to generate a cubic simulation box for our system.  
    The molecule should be centred in the box, and a separation of 1 nm should be kept between
    the box and the molecule.
  </p>

  <details class="solution-box">
    <summary>üëÅÔ∏è Solution</summary>
    <pre><code>gmx editconf -f molecule.gro -o box.gro -c -d 1.0 -bt cubic</code></pre>
  </details>
</div>

<style>
.exercise-box {
  border: 2px solid #f0c27b;
  background-color: #fff8e1;
  border-radius: 10px;
  padding: 16px;
  margin: 20px 0;
  box-shadow: 0 2px 5px rgba(0,0,0,0.05);
}

.exercise-header {
  background-color: #f3cd88;
  color: #4a3a1f;
  font-weight: bold;
  padding: 6px 10px;
  border-radius: 6px;
  margin-bottom: 10px;
  font-size: 1.1em;
}

.solution-box summary {
  background-color: #f0ede3;
  padding: 8px 12px;
  border-radius: 6px;
  font-weight: bold;
  cursor: pointer;
}

.solution-box[open] summary {
  background-color: #e2dcc4;
}

.solution-box pre {
  background-color: #f6f4eb;
  padding: 10px;
  border-radius: 6px;
  margin-top: 8px;
  overflow-x: auto;
}
</style>


References:
1. GROMACS User Manual, https://manual.gromacs.org/current/install-guide/index.html
2. 
3. 